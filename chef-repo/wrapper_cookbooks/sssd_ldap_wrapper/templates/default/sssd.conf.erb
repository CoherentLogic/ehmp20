#
# Managed by Chef
# /etc/sssd/sssd.conf
#
[sssd]
config_file_version = 2
services = nss, pam<% if node['sssd_ldap']['ldap_sudo'] == 'true' %>, sudo<% end %>
domains = LDAP

[nss]
filter_users = root,named,avahi,haldaemon,dbus,radiusd,news,nscd

[pam]

[sudo]

[domain/LDAP]
auth_provider = <%= node['sssd_ldap']['auth_provider'] %>
chpass_provider = <%= node['sssd_ldap']['chpass_provider'] %>
<% if node['sssd_ldap']['ldap_sudo'] == 'true' %>sudo_provider = <%= node['sssd_ldap']['sudo_provider'] %><% end %>
id_provider = <%= node['sssd_ldap']['id_provider'] %>
cache_credentials = <%= node['sssd_ldap']['cache_credentials'] %>
enumerate = <%= node['sssd_ldap']['enumerate'] %>

ldap_schema = <%= node['sssd_ldap']['ldap_schema'] %>
ldap_uri = <%= node['sssd_ldap']['ldap_uri'] %>

ldap_tls_reqcert = <%= node['sssd_ldap']['ldap_tls_reqcert'] %>
ldap_tls_cacertdir = <%= node['sssd_ldap']['ldap_tls_cacertdir'] %>
ldap_id_use_start_tls = <%= node['sssd_ldap']['ldap_id_use_start_tls'] %>

ldap_search_base = <%= node['sssd_ldap']['ldap_search_base'] %>
ldap_user_search_base = <%= node['sssd_ldap']['ldap_user_search_base'] %>
ldap_user_object_class = <%= node['sssd_ldap']['ldap_user_object_class'] %>
ldap_user_name = <%= node['sssd_ldap']['ldap_user_name'] %>
<% if node['sssd_ldap']['override_homedir'] %>
override_homedir = <%= node['sssd_ldap']['override_homedir'] %>
<% end %>
shell_fallback = <%= node['sssd_ldap']['shell_fallback'] %>

ldap_group_search_base = <%= node['sssd_ldap']['ldap_group_search_base'] %>
ldap_group_object_class = <%= node['sssd_ldap']['ldap_group_object_class'] %>

<% if node['sssd_ldap']['ldap_default_bind_dn'] %>ldap_default_bind_dn = <%= node['sssd_ldap']['ldap_default_bind_dn'] %><% end %>
<% if node['sssd_ldap']['ldap_default_authtok'] %>ldap_default_authtok = <%= node['sssd_ldap']['ldap_default_authtok'] %><% end %>

<% if node['sssd_ldap']['ldap_access_filter'] %>
access_provider = <%= node['sssd_ldap']['access_provider'] %>
ldap_access_order = <%= node['sssd_ldap']['ldap_access_order'] %>
ldap_access_filter = <%= node['sssd_ldap']['ldap_access_filter'] %>
<% end %>

<% if node['sssd_ldap']['ldap_sudo'] == 'true' %>
ldap_sudo_search_base = ou=sudoers,<%= node['sssd_ldap']['ldap_search_base'] %>
ldap_sudo_full_refresh_interval = 86400
ldap_sudo_smart_refresh_interval = 3600
<% end %>

min_id = <%= node['sssd_ldap']['min_id'] %>
max_id = <%= node['sssd_ldap']['max_id'] %>
